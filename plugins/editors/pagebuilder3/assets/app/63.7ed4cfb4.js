webpackJsonppagefly([63],{691:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"default",function(){return T}),n.d(e,"StyledBar",function(){return S}),n.d(e,"StyledLink",function(){return P});var i,o,a=n(361),r=n.n(a),l=n(49),c=n.n(l),u=n(141),d=n.n(u),p=n(349),s=n.n(p),f=n(350),g=n.n(f),h=n(351),b=n.n(h),m=n(352),k=n.n(m),v=n(13),x=(n.n(v),n(29)),y=n.n(x),E=n(358),C=(n(365),n(355),n(353)),R=n(356),L=n(357),_=n(362),w=(n(405),n(406),n(146),r()(["\n\t& {\n\t\tvisibility: hidden;\n\t\tposition: absolute;\n\t\ttop: 100px;\n\t\tleft: 100px;\n\t\tpadding: 0 6px;\n\t\tbackground: #444;\n\t\tborder: 1px solid #333;\n\t\tborder-radius: 3px;\n\t\tbox-sizing: border-box;\n\t\tz-index: 1000;\n\n\t\t* {\n\t\t\tpadding: 0;\n\t\t\tmargin: 0;\n\t\t\tcolor: #eee !important;\n\t\t\tfont-size: 14px;\n\t\t}\n\t\tbutton {\n\t\t\tline-height: 24px;\n\t\t\tmin-width: 24px;\n\t\t\tdisplay: block;\n\t\t}\n\t\tbutton[data-active='true'] {\n\t\t\tbackground: #777 !important;\n\t\t\t* {\n\t\t\t\tcolor: white !important;\n\t\t\t}\n\t\t}\n\t}\n"],["\n\t& {\n\t\tvisibility: hidden;\n\t\tposition: absolute;\n\t\ttop: 100px;\n\t\tleft: 100px;\n\t\tpadding: 0 6px;\n\t\tbackground: #444;\n\t\tborder: 1px solid #333;\n\t\tborder-radius: 3px;\n\t\tbox-sizing: border-box;\n\t\tz-index: 1000;\n\n\t\t* {\n\t\t\tpadding: 0;\n\t\t\tmargin: 0;\n\t\t\tcolor: #eee !important;\n\t\t\tfont-size: 14px;\n\t\t}\n\t\tbutton {\n\t\t\tline-height: 24px;\n\t\t\tmin-width: 24px;\n\t\t\tdisplay: block;\n\t\t}\n\t\tbutton[data-active='true'] {\n\t\t\tbackground: #777 !important;\n\t\t\t* {\n\t\t\t\tcolor: white !important;\n\t\t\t}\n\t\t}\n\t}\n"])),D=r()(["\n\t& {\n\t\tdisplay: none;\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tpadding: 5px;\n\t\tbackground: ",";\n\t\tborder: 1px solid ",";\n\t\tborder-radius: 3px;\n\t\tbox-sizing: border-box;\n\t\twidth: 300px;\n\n\t\tinput,\n\t\tbutton {\n\t\t\tborder: 1px solid "," !important;\n\t\t\tbackground: "," !important;\n\t\t\tborder-radius: 3px !important;\n\t\t\tpadding-left: 5px;\n\t\t\tcolor: "," !important;\n\t\t}\n\t\tbutton {\n\t\t\twidth: 20px;\n\t\t}\n\t}\n"],["\n\t& {\n\t\tdisplay: none;\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tpadding: 5px;\n\t\tbackground: ",";\n\t\tborder: 1px solid ",";\n\t\tborder-radius: 3px;\n\t\tbox-sizing: border-box;\n\t\twidth: 300px;\n\n\t\tinput,\n\t\tbutton {\n\t\t\tborder: 1px solid "," !important;\n\t\t\tbackground: "," !important;\n\t\t\tborder-radius: 3px !important;\n\t\t\tpadding-left: 5px;\n\t\t\tcolor: "," !important;\n\t\t}\n\t\tbutton {\n\t\t\twidth: 20px;\n\t\t}\n\t}\n"]),N={Self:"_self",New:"_blank",Top:"_top"},T=(o=i=function(t){function e(){var t;s()(this,e);for(var n=arguments.length,i=Array(n),o=0;o<n;o++)i[o]=arguments[o];var a=b()(this,(t=e.__proto__||d()(e)).call.apply(t,[this].concat(i)));return a.boundTbEl=y()("<div>").css({opacity:.5,position:"absolute",pointerEvents:"none",zIndex:9999999}),y()(a.get("app.element")).append(y()(a.boundTbEl)),a.boundTeEl=y()("<div>").css({opacity:.5,position:"absolute",pointerEvents:"none",zIndex:9999999}),y()(a.get("app.element")).append(y()(a.boundTeEl)),a}return k()(e,t),g()(e,[{key:"targetBoundingBox",value:function(t,e){var n={top:Math.min(t.top,e.top),bottom:Math.max(t.bottom,e.bottom),left:Math.min(t.left,e.left),right:Math.max(t.right,e.right),width:0,height:0};return n.width=n.right-n.left,n.height=n.bottom-n.top,n}},{key:"componentDidMount",value:function(){var t=this;this.listenTo(this.app,"change:selection:bounds",function(){t.updatePosition(),t.hideLink()}),this.listenTo(this.app,"richtexteditor:show",function(){t.updatePosition(),t.hideLink(),t.forceUpdate()})}},{key:"updatePosition",value:function(){if(this.el){if(y()(this.el).css({visibility:"hidden",opacity:0}),!this.target)return;if("Paragraph"!==this.target.props.type)return;var t=(this.target.DOMNode,this.target.page.window.getSelection()),e=t.rangeCount&&t.getRangeAt(0);t.focusNode;if(!e||e&&e.startContainer===e.endContainer&&e.startOffset===e.endOffset)return;var n=this.get("parent.parent.el"),i=this.get("parent.parent.__toolbar.el.el"),o=this.get("context.editor.mainEl");if(n&&i&&o){var a=n.getBoundingClientRect(),r=i&&i.getBoundingClientRect()||void 0,l=this.targetBoundingBox(a,r||a);y()(this.boundTbEl).css(l),y()(this.el).css({visibility:"visible",opacity:1}).position({my:"bottom",at:"top",of:this.boundTbEl,collision:"flipfit",within:o,using:function(t,e){"top"===e.vertical?e.element.element.css({top:t.top+4,left:t.left}):"bottom"===e.vertical&&e.element.element.css({top:t.top-4,left:t.left}),e.element.element.css({visibility:"visible",opacity:1})}})}}}},{key:"updatePositionLink",value:function(t){var e=this;if(this.elLink){if(y()(this.elLink).css({display:"none"}),"none"===t)return;var n=(this.get("parent.parent.el"),this.el),i=this.get("app.editor.parent.parent.el"),o=n.getBoundingClientRect(),a=this.targetBoundingBox(o,y()(this.boundTbEl)[0].getBoundingClientRect());this.boundTeEl.css(a),y()(this.elLink).css({display:t}).position({my:"bottom",at:"top",of:this.boundTeEl,collision:"flipfit",within:i,using:function(t,e){"top"===e.vertical?e.element.element.css({top:t.top+4,left:t.left}):"bottom"===e.vertical&&e.element.element.css({top:t.top-4,left:t.left})}}),this.getLink().then(function(t){e.linkInput.updateValue(t.href),e.linkTarget.updateValue(t.target)})}}},{key:"onSubmitLink",value:function(t){var e=this,n=this.linkInput.value;n&&""!==n&&"http://"!==n?(this.target._text.formatDoc("createlink",n),this.getLink().then(function(t){return t.target=e.linkTarget.value}),this.invoke("app.notify.addNotification",{level:"success",message:"Link is updated."})):this.invoke("app.notify.addNotification",{level:"error",message:"Error! Please check your link."})}},{key:"onExitLink",value:function(t){this.hideLink()}},{key:"onUnlink",value:function(t){var e=this;this.getLink().then(function(t){"http://"!==t.href?(e.target._text.formatDoc("unlink"),e.invoke("app.notify.addNotification",{level:"success",message:"You have unlinked."})):e.invoke("app.notify.addNotification",{level:"error",message:"There is no link to remove."})})}},{key:"showLink",value:function(){var t=y()(this.elLink).css("display");t="none"===t?"block":"none",this.updatePositionLink(t)}},{key:"hideLink",value:function(){y()(this.elLink).css("display","none")}},{key:"getLink",value:function(){var t=this;return new c.a(function(e,n){var i=t.get("app.page"),o=i.document.getSelection().focusNode,a=void 0;o&&(a=o.parentElement),e(a&&a.href?a:{href:"http://",target:"_self"})})}},{key:"render",value:function(){var t=this,e={backgroundColor:"",bold:!1,italic:!1,underline:!1,color:"",verticalAlign:""};if(this.target){var n={},i=this.target.DOMNode,o=i,a=this.target.page.window.getSelection(),r=a.rangeCount&&a.getRangeAt(0),l=a.focusNode;if(r&&(!r||r.startContainer!==r.endContainer||r.startOffset!==r.endOffset)&&l){for(i=l.parentElement,o=i;"SPAN"!==o.nodeName&&(o.parentElement&&"SPAN"!==o.parentElement.nodeName||"A"===o.nodeName);)o=o.parentElement;n=o.style,e.backgroundColor=""===n.backgroundColor?"rgb(255, 255, 255)":n.backgroundColor,e.color=""===n.color?"rgb(255, 255, 255)":n.color,e.bold="bold"===n.fontWeight,e.underline="underline"===n.textDecorationLine,e.italic="italic"===n.fontStyle}e.verticalAlign=n.verticalAlign}return E.React.createElement("div",null,E.React.createElement(S,{innerRef:function(e){return t.el=e}},E.React.createElement(C.default,null,E.React.createElement(R.default,{icon:"font",onClick:function(n){t.app.launch("colorPicker").then(function(n){n.show({color:e.color,target:t.target.DOMNode,change:function(e){t.target&&t.target._text.formatDoc("foreColor",e)}})})},style:{fontSize:12},plain:!0,tooltip:"Text Color"},E.React.createElement("span",{style:{height:2,display:"block",margin:"0px 3px",backgroundColor:e.color}})),E.React.createElement(R.default,{icon:"paint brush",onClick:function(n){t.app.launch("colorPicker").then(function(n){n.show({color:e.backgroundColor,target:t.target.DOMNode,change:function(e){t.target&&t.target._text.formatDoc("backColor",e)}})})},style:{fontSize:12},plain:!0,tooltip:"Background Color"},E.React.createElement("span",{style:{height:2,display:"block",margin:"0px 3px",backgroundColor:e.backgroundColor}})),E.React.createElement(R.default,{icon:"numbered list",onClick:function(e){t.target&&t.target._text.formatDoc("insertOrderedList")},plain:!0,tooltip:"Number List"}),E.React.createElement(R.default,{icon:"dotted list",onClick:function(e){t.target&&t.target._text.formatDoc("insertUnorderedList")},plain:!0,tooltip:"Dotted List"}),E.React.createElement(R.default,{icon:"outdent",onClick:function(e){t.target&&t.target._text.formatDoc("outdent")},plain:!0,tooltip:"Outdent"}),E.React.createElement(R.default,{icon:"indent",onClick:function(e){t.target&&t.target._text.formatDoc("indent")},plain:!0,tooltip:"Indent"}),E.React.createElement(R.default,{icon:"superscript",active:"super"===e.verticalAlign,onClick:function(e){t.target&&t.target._text.formatDoc("superscript")},plain:!0,tooltip:"Superscript"}),E.React.createElement(R.default,{icon:"subscript",active:"sub"===e.verticalAlign,onClick:function(e){t.target&&t.target._text.formatDoc("subscript")},plain:!0,tooltip:"Subscript"}),E.React.createElement(R.default,{icon:"bold",active:e.bold,onClick:function(e){t.target&&t.target._text.formatDoc("bold")},plain:!0,tooltip:"Bold"}),E.React.createElement(R.default,{icon:"italic",active:e.italic,onClick:function(e){t.target&&t.target._text.formatDoc("italic")},plain:!0,tooltip:"Italic"}),E.React.createElement(R.default,{icon:"underline",active:e.underline,onClick:function(e){t.target&&t.target._text.formatDoc("underline")},plain:!0,tooltip:"Underline"}),E.React.createElement(R.default,{icon:"linkify",onClick:function(e){t.showLink()},plain:!0,tooltip:"Insert/edit Link"}),E.React.createElement(R.default,{icon:"chain broken",onClick:this.onUnlink,plain:!0,tooltip:"Remove link"}),E.React.createElement(R.default,{icon:"eraser",onClick:function(e){t.target&&t.target._text.formatDoc("removeFormat")},plain:!0,tooltip:"Clear"}))),E.React.createElement(P,{innerRef:function(e){return t.elLink=e}},E.React.createElement(C.default,null,E.React.createElement(L.default,{ref:function(e){return t.linkInput=e},flex:"2",onChange:function(e){t.linkInput.updateValue(e)}}),E.React.createElement(_.default,{flex:"1",ref:function(e){return t.linkTarget=e},options:N})),E.React.createElement(C.default,null,E.React.createElement(R.default,{label:"Cancel",onClick:this.onExitLink}),E.React.createElement(R.default,{label:"Update",onClick:this.onSubmitLink}))))}}]),e}(E.default),i.APP_POS="selection",o),S=E.styled.div(w),P=E.styled.div(D,function(t){return t.theme.panel.bg},function(t){return t.theme.panel.border},function(t){return t.theme.button.border},function(t){return t.theme.button.bg},function(t){return t.theme.button.text})}});